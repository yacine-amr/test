---
title: "Analysing the Guru.com User Base for Effective Marketing campaign Targeting, Graphic design Gategory"
author: "Yassine Ammour"
date: "05-02-2023"
output:
  html_document:
    number_sections: yes
    theme: united
    toc: yes
    toc_float: yes
    dev: svg
    highlight: haddock
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = TRUE, 
               cache = FALSE,
               prompt = FALSE,
               tidy = TRUE,
               comment = NA,
               message = FALSE,
               warning = FALSE,
               fig.width = 7.4,
               fig.height = 4.7,
               fig.align = "center")
opts_knit$set(width = 75)
```

<style> 
tr {font-family: 'Fira Mono'; font-size:90%}
code, kbd,pre,samp {font-family: 'Fira Mono';
                    background-color: rgba(237, 125, 49, 0.04)}
body, h1, h2, h3, h4, h5 {font-family: 'Fira Sans'}
</style>



# Introduction
Guru.com is a freelance website that connects businesses with freelance service providers. The website has a large user base, consisting of service providers from various countries. In this analysis, i aim to study the top 10 countries in the graphic design category based on various parameters such as total yearly earnings, all-time earnings, number of transactions, number of service providers, returning customers, highest transaction prices, and date of joining, in order to identify the most valuable customers for guru.com and impact their marketing decisions

__Why It's Worth Solving:__

Understanding the user base of a website is crucial for any business. The insights gathered from this analysis will help Guru.com make informed decisions regarding product development, marketing strategies, and customer engagement. For example, the analysis can reveal the countries that generate the most revenue, the countries with the most returning customers, and the countries with the highest transaction prices. These insights can help Guru.com target its marketing efforts to these countries, ensuring a better return on investment. Additionally, the analysis can also help Guru.com understand which countries have the highest number of service providers, allowing it to determine whether it should invest in improving the user experience for service providers in those countries. Overall, this analysis is essential for Guru.com to stay competitive in the market and grow its user base.


## Brief about Scraping Methodology :

1. Collect 99917 Links from the main webpages.
2. Collect data from each of the links.
3. Data processing and cleaning.
4. Analysis and Plotting.

__Loading the necessary packages:__
```{r}
library(rvest)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(stringi)
```




__This is what the data looks like after scraping and cleaning:__
```{r}
df_data <- read.csv("data_to_analyse.csv")
kable(df_data[1:8, ])
```


# Ploting and Analysis 

## Density plot of hourly rate: 

- This plot can help us understand the distribution of hourly rates among the service providers.

```{r}
ggplot(df_data, aes(x = hourly_rate)) +
  geom_density() +
  xlab("Hourly Rate") +
  ggtitle("Density Plot of Hourly Rate")
```


## Top 10 countries based on total yearly earnings :

__Preparing a sub data for the plot:__

1. Groups the data by the "country".
2. calculate the sum of all yearly earnings for each country.
3. Arranges the data in descending order and Selects the top 10 countries.

```{r}
top_10_countries <- df_data %>%
  group_by(country) %>%
  summarize(total_yearly_earnings = sum(yearly_earnings)) %>%
  arrange(desc(total_yearly_earnings)) %>%
  slice(1:10)
```

__The Plot:__

- This plot help in visualizing and comparing the revenue generated by service providers from different countries. This plot  provide insights into which countries contribute the most to Guru.com's revenue. 

```{r}
ggplot(top_10_countries, aes(x = reorder(country, total_yearly_earnings), y = total_yearly_earnings)) +
  geom_bar(stat = "identity") +
  xlab("Country") +
  ylab("Total Yearly Earnings") +
  ggtitle("Top 10 Countries based on Total Yearly Earnings") +
  coord_flip()
```


## Top 10 countries based on total number of transactions :

__Preparing a sub data for the plot:__

1. Groups the data by the "country".
2. calculate the sum of all transactions for each country.
3. Arranges the data in descending order and Selects the top 10 countries.
```{r}
top_10_countries <- df_data %>%
  group_by(country) %>%
  summarize(total_transactions = sum(transactions)) %>%
  arrange(desc(total_transactions)) %>%
  slice(1:10)
```

__The Plot:__

- This plot help helps to understand which countries have the highest volume of transactions, or purchases made, on the website. This information can be useful in identifying the most popular countries among customers and therefore provide insight into the market demand for services provided on the website. 
```{r}
ggplot(top_10_countries, aes(x = reorder(country, total_transactions), y = total_transactions)) +
  geom_bar(stat = "identity") +
  xlab("Country") +
  ylab("Total Transactions") +
  ggtitle("Top 10 Countries based on Total Number of Transaction") +
  coord_flip()
```



## Top 10 Countries by Number of Service Providers :

__Preparing a sub data for the plot:__

1. Aggregate the data by country.
2. Rank the countries based on the number of service providers.
3. Select the top 10 countries.

```{r}
agg_data <- df_data %>%
  group_by(country) %>%
  summarize(num_service_providers = n_distinct(service_provider_name))
agg_data <- agg_data %>%
  arrange(desc(num_service_providers))
top_10_countries <- head(agg_data, 10)
```


__The Plot :__

- This plot helps to understand the concentration of service providers in different countries. This information is useful in identifying the countries where the company has a high number of service providers. Additionally, it provides insight into the competition level for service providers in these countries and the market potential in terms of the number of service providers. 

```{r}
ggplot(top_10_countries, aes(x = reorder(country, num_service_providers), y = num_service_providers)) +
  geom_bar(stat = "identity") +
  xlab("Country") +
  ylab("Number of Service Providers") +
  ggtitle("Top 10 Countries by Number of Service Providers") +
  coord_flip()
```


## Top 10 Countries with Returning Customers :

__Preparing a sub data for the plot:__

1. Aggregate the data by country.
2. Rank the countries based on the mean number of transactions per employer.
3. Select the top 10 countries.

```{r}
agg_data <- df_data %>%
  group_by(country) %>%
  summarize(mean_employers = mean(employers),
            mean_transactions = mean(transactions))
agg_data <- agg_data %>%
  mutate(returning_customers = mean_transactions / mean_employers) %>%
  arrange(desc(returning_customers))
top_10_countries <- head(agg_data, 10)
```

__The Plot :__

- This plot help us understand the number of repeat customers in each of the top 10 countries. This information can give us insights into the customer loyalty and satisfaction level of your customers in these countries. This information can also help us understand the buying behavior of their customers and how to better serve them in the future.

```{r}
ggplot(top_10_countries, aes(x = reorder(country, returning_customers), y = returning_customers)) +
  geom_bar(stat = "identity") +
  xlab("Country") +
  ylab("Mean Number of Transactions per Employer") +
  ggtitle("Top 10 Countries with Returning Customers") +
  coord_flip()

```


## Top 10 Countries with the Highest Transaction Prices :

__Preparing a sub data for the plot:__

1. for this i selected the top 1000 service providers 
2. Aggregate the data by country
3. Calculate the average transaction price for each country
4. Select the top 10 countries

```{r}
top_1000 <- head(df_data[order(df_data$ratings, decreasing = TRUE), ], 1000)
agg_data <- top_1000 %>%
  group_by(country) %>%
  summarize(sum_earnings = sum(all_time_earnings),
            sum_transactions = sum(transactions))
agg_data <- agg_data %>%
  mutate(avg_transaction_price = sum_earnings / sum_transactions) %>%
  arrange(desc(avg_transaction_price))
top_10_countries <- head(agg_data, 10)
```


__The Plot :__

- This plot will help the company identify the countries where their services are highly valued and where the customers are willing to pay more for their services. This information can then be used to target those countries with more marketing efforts and potentially increase the number of transactions.
```{r}

ggplot(top_10_countries, aes(x = reorder(country, avg_transaction_price), y = avg_transaction_price)) +
  geom_bar(stat = "identity") +
  xlab("Country") +
  ylab("Average Transaction Price") +
  ggtitle("Top 10 Countries with the Highest Transaction Prices") +
  coord_flip()

```



## Members Date of joining from each country of the Top 10:

__Preparing a sub data for the plot:__

1. Convert the member_since column to a date object "year"
2. Aggregate the data by country and year
3. Define the list of countries
4. Extract only the rows with the specified countries

```{r}
df_data$year <- as.numeric(str_extract(df_data$member_since, "\\d+"))
agg_data <- df_data %>%
  group_by(country, year) %>%
  summarize(num_service_providers = n_distinct(service_provider_name))
countries <- c("USA", "India", "Pakistan", "Bangladesh", "United", "Philippines", "Egypt", "Canada", "Indonesia", "Ukraine")
data_subset <- subset(agg_data, country %in% countries)
```


__The Plot :__

__- This plot will help the company in :__

1. Understanding the trend of member joining over time.
2. Identifying the active countries : The plot can help the company to identify which countries have a large number of members joining and which are not.
3. Targeting specific countries : Based on the data from the plot, the company can focus its marketing efforts on countries with a high rate of new members joining.
4. Optimizing business strategies : The plot can provide insight into which countries have a high rate of returning members, which can help the company to optimize its business strategies in those countries.

```{r}
ggplot(data_subset, aes(x=year, y=num_service_providers, color=country)) +
  geom_line() +
  scale_x_continuous(limits=c(min(data_subset$year), max(data_subset$year))) +
  labs(x="Year", y="Number of Service Providers", color="Country") +
  ggtitle("Number of Service Providers by Year and Country")
```


# Analysis Results and Conclusions :

- The dominant hourly rate is between 10 dollars/h and 30 dollars/h.
- Service providers from the USA are on top of the list in terms of generating the most amount of income.
- USA is the number one country contributing in Guru.com's revenue.
- India is close the the USA in terms of volume of transactions, which means the market demand in India is very large, but this does not reflect on the money earned from the website simply because of cheap labour.
- USA, India and Pakistan are the top three in terms of service providers, which indicate the popularity of the website in these countries.
- Panama is the number one country in terms of repeated customers, which reflect a hight level of loyalty and satisfaction.
- People from Italy are paying the most amount of money per transaction.
- the last plot indicate that people from USA are the early joiners, that is because the website is born in the united states.
- Service providers from India and Pakistan joined the website by high volumes from 2015 to Now, which means the website got really populare in these countries that period.


__Takeaways:__

1. Guru.com should invest heavenly in countries like __USA, India, Pakistan and Italy.__
2. Marketing efforts should target those countries first because those are the most valuable customers, and then they can experiment with other countries.
3. The company should double or triple their marketing efforts in countries like __India__ and __Pakistan__, those are early joiners in terms of the history of the website, and they ARE MEGA countries in terms of population, so there is a big opportunity there.



